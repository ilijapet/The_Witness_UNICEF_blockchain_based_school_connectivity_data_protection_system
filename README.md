Author: Ilija Petronijevic

Email: ilijapet@gmail.com

Title: The Witness: blockchain based school connectivity data collection, monitoring and protection system

Project Summary

Main goal of this project is to bring the power of blockchain and cryptography to the world of schools connectivity and in this way ensure data integrity about internet usage.

In most general terms, the current state of affairs reveals that data on communication devices is primarily safeguarded by promises made by device producers and, at best, by policy documents, rather than by robust data protection technologies. The frequency of these promises being broken has led us to recognize the necessity for a novel approach to addressing the issue of communication device usage data integrity. Here we are proposing a new solution that places greater emphasis on cryptographic and blockchain guarantees to establish and ensure user trust in data about usage. As devices around us proliferate and become increasingly integrated in our everyday life ensuring the reliability of the data they contain becomes paramount. This project intends to experiment and demonstrate how blockchain and cryptography can address some of those challenges.

Cartesi unique value proposition: we believe that using the Cartesi backend will allow us to build more complex data analytics compared to what is currently available and possible within EVM framework. In the first place we will focus on preserving data integrity about daily connectivity of school devices. In scenarios where we feed huge amounts of data generated by devices all around the world into UNICEF backend when using Cartesi we can to rely on the rich Python ecosystem of data analytic libraries to digest all that data and to transform into insights valuable for our end user. For example information about daily connectivity over the time (school ID, timestamp, download/upload speeds, latency) or any other higher order statistic of analytics.

IMPORTANT: In case developers reading this don't have for easier exposure to Cartesi tech stack, it is highly reccomendent to take a look on this page for easier understating of proposed dapp. Because Cartesi architecture if diverging from typical EVM based architectures that we used to work on L1 or optimistic of zk L2's. Here is where you can find more information's https://docs.cartesi.io/cartesi-rollups/1.5/core-concepts/architecture/

Scope & Methodology:

We will develop small front-end, Django backend and Cartesi backend for data ingestion coming from huge number of schools from all around the world.

Here are description of basic flow:

1. On the Django backend mock data from school communication device
2. Submit this data to Django bridge app, where data get's signed and submited to `inputBox` Cartesi contract (gateway to UNICEF & Cartesi backend)
3. Cartesi rool-up node listen for this submitted tx data, receives data and submit back to Cartesi backend for further processing
4. Cratesi backend receive encrypted data, decrypts data, confirm that data are coming for valid school device (via asymmetric key cryptography) and decode data back into plain text (python dict)
5. If everything goes well Cartesi backend will now process and record new entry into database
6. After few transaction circles Cartesi (Cartesi epoche) whole state of Cartesi machine will be recorded back via set of optimistic roll up contract for other Node from UNICEF / Cartesi node networks to be able to challenge hash valued submitted by proposer
7. If all other nodes in Cartes/UNICEF network of nodes confirm that they get same hash value by replaying transaction inputs in their local environments, new state of machine will be recognized as final and whole process can be repeated with new incoming data
8. From the user perspective, he can via our React front-end query Cartesi backend for data and show what history of state of devcies

As we mentioned earlier inside this project we will build 3 basic components:

1. Cartesi Dapp backend for processing inputs and maintain state of the connectivity devicies from school.
2. Django REST backend which will receive data inputs from school devices and sign transaction to be submitted to blockchain (and then via blockchain further to Cartesi Dappp backend). This Django REST backend will also be used to serve
3. React frontend with necessary information about device usage
4. Then we will build mock connectivity devices to be used to generate mock data from schools and to feed that data into the Django REST backend. Also this mock school devices will be used in data verification processes implemented as processes between device and Cartesi backend.

Basic underlying cryptographic protocol

We want to ensure following characteristics of communication between 3 elements: school device (local computer submitidng data), Django Backend and Cartesi backend:

1. School Device > Django backend relation: In this relation we should preserve confidentiality, data integrity and confirm authenticity. Django should know that data is coming from the correct IoT device but at the same time it should not be able to see raw data as well as not to temper with received data.

2. Django backend > Cartesi backend relation: In this relation we need to confirm only authenticity. On the Cartesi side and in this relation alone we need to confirm only if a message is coming from the Django server.

3. Cartesi backend - school device relation: Lastly we have authenticity, confidentiality and integrity between IoT device and Cartesi. We need to know that the message originates from an expected school device whihc are part of our data protection network (authenticity), that the message is in integral form (integrity) and that data is in encrypted form (confidentiality).

To achieved this described properties we will implement following steps:

Generate public-private key pairs for school device, Django and Catesi backend. Store public key from school device on Django server and associate with school device ID (for authenticity). Store public key from school device on Cartesi server and associate with school device ID. Store public key of Cartesi server on device for encryption purpose.

Write flow: school device perspective

School device (local computer) generate data (school ID, timestamp, download/upload speeds, latency) and encrypt with Cartesi backend public key to preserve confidentiality of original data while passing through Django backend. Sign encrypted data with school device private keys. Send encrypted message and digital signature to Django backend

Django backend

Django backend receive encrypted message and digital signature from school device. By using this two values and school public key verify signature (confirmation about source of data). Submit tx and send encrypted message and school device signature to Cartesi backend

Cartesi backend

Cartesi backend receive encrypted message and signature. Cartesi verify via encrypted message, signature and Django public key that message is indeed coming from Django backend. If thatâ€™s ok, then it takes an encrypted message and its own private key and decrypts the message getting in return plain school device metric data (school ID, timestamp, download/upload speeds, latency). In last step update state in database related to that school device and do some data analytics (if necessary).

Here on this point I would like ones again to point out advantage of Cartesi architecture compared to classical EVM's. Because with Cartesi we can use which every Python or Linux library we need. While in context of EVM operate with constrains of this architecture.

Tech stack for this phase of project will be: React, Django REST, web3.py, Cartesi rollups package, Docker, Github, Github action, Git and supporting Python cryptographic and other libraries (pycryptodome, crypto or similar).

Value proposition: Device data integrity is protected. Users know that identity (as data about device usage) are uncompressed. In scenarios when someone want's to manipulate data directly on device we can always look back in history via our front end and compare current on-device state with one recorded over blockchain.

## How to run and test The Witness dapp locally on your machine?

You need to have on your machine Python, Cartesi CLI, Yarn and Docker. Beside this you will need to run following steps:

1. `git clone https://github.com/ilijapet/The_Witness_UNICEF_blockchain_based_school_connectivity_data_protection_system`

2. Install Cartesi command line tool `npm install -g @cartesi/cli` For more informations: https://docs.cartesi.io/cartesi-rollups/1.3/development/installation/

3. cd into `cartesi_backend`

4. `python -m venv .venv && source .venv/bin/activate` And then `pip install -r requirements.txt`

5. Add `.env` file to `cartesi_frontend` and to `cartesi_backend`. Then add `.env_dev` to backend

6. Run Docker engine in background (as desktop or from command line)

7. run `cartesi build` and then `cartesi run`. Ones you type `cartesi run` you need to wait first time few minutes. Every next time Cartesi backend will be run immediately.

8. Open separate terminal and cd into `backend` folder

9. Run `python -m venv .venv && source .venv/bin/activate`

10. `pip install -r requirements.txt` and then `python -m manage runserver 8005`

11. cd into `cartesi_frontend` and run `yarn install` and then `yarn run dev` for React frontend server

12. Then you can just go to The Witness frontend via `http://localhost:8081/` and login in with test email `ilijapet@gmail.com` with test password `Meridseli1986!`

At this point you will be able to monitor basic school communication device performance generated via our mock script in Django backend and passed through set of Cartesi contracts and then to our Cartesi backend.

#TODO: add .env files
